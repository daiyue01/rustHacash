// use hacash::interface::*;
use hacash::cores::blocks;

/*
    cargo test --test block -- --nocapture
*/

#[test]
fn blocks() {

    /*
    01
    000005606c
    0062a59ce2
    0000000001602746b6ee70cbedbc67b4dea2ccf567739d5e83bd4781d9a0ab32
    c13cd63c7120356d069d9282d1bf85b40e5d35d5171af0aba68a3997e259dd8b
    00000005
    fedd4f79
    d8c7a4d0
    0000
    ---- coinbase
89  00
90  001a9ffb585dd247d351dae9c18031d7e3c762d7a2
111 f80103 : amt
96  576f575f3035323700000000000000fa
97  01 : extend
    0000000000000000000000000000000000000000000000000000000000000000
    00
    ---- trs type 2
    020062a59b99001a9ffb585dd247d351dae9c18031d7e3c762d7a2f3010f00020001006803f6f526aa2a85aa39142c14aa12ba88ba8867f0042608a3a8000100fc6038915c31971586e3e1a7b9d49e0baa7621a9f00434c338960001032ede4b998a48aeaeea76c87e9cf327eb0a256b080da0df056844ca1113d50c8fdc6a9f0415a8001ce1ca02edf3e02c324f1b2d932e2369f0b9bcb3e9be9b7d133b36f383bee31827ef0e2b307fac725ab6ad2b1ba4c86d52edc03bdeb4bb69d50000020062a59b9800d756b52b0a5c51e529ba0d1513b0de493bacd33af401010001000100d756b52b0a5c51e529ba0d1513b0de493bacd33af80106000103ac1f279d13bf061508d6d8fa63af05615357dedd7de0d9da6aaf88b9ce5ca8af2a0e1f47559ab40dfd54ed4fb1f7b366dd2496f8fdd2e19a37fe185fca9703b57f00074248de0db2083c4436062cb39578a67c3ddbbc746fa7b2cdab2b0311740000020062a59b990052d06d40b44e0e38746f9e2188102ee48ff1c96bf40101000100010052d06d40b44e0e38746f9e2188102ee48ff1c96bf7014800010307d18b73279b14848e84d48f97576c3e6432df190b29da94df8b916570fe96f87f8f88848be1ea2365aef7af72377a0b5e68c074146fde37eaaca8f765572f2f4b8a99da495b636f2b53860ab88d2ac1fa5256bf574239d06bb2f47dfa5e38e90000020062a59b990013f84fb90413aeeda813cd5451402cc083287fd7f4010100010001006803f6f526aa2a85aa39142c14aa12ba88ba8867f801030001025dac43a5673446fb666cc75999077e634546061e86cf7395987d567a8680fb4950081aa4848584855b667a5785cd927868042fb9229665660f98ad5f1665b6be03b38270640ace7bcb744e722b33158c1db3d761314a39f0c844d17c5c63f6210000
    
    
    */

    let blkdtstr = "01000005606c0062a59ce20000000001602746b6ee70cbedbc67b4dea2ccf567739d5e83bd4781d9a0ab32c13cd63c7120356d069d9282d1bf85b40e5d35d5171af0aba68a3997e259dd8b00000005fedd4f79d8c7a4d0000000001a9ffb585dd247d351dae9c18031d7e3c762d7a2f80103576f575f3035323700000000000000fa01000000000000000000000000000000000000000000000000000000000000000000020062a59b99001a9ffb585dd247d351dae9c18031d7e3c762d7a2f3010f00020001006803f6f526aa2a85aa39142c14aa12ba88ba8867f0042608a3a8000100fc6038915c31971586e3e1a7b9d49e0baa7621a9f00434c338960001032ede4b998a48aeaeea76c87e9cf327eb0a256b080da0df056844ca1113d50c8fdc6a9f0415a8001ce1ca02edf3e02c324f1b2d932e2369f0b9bcb3e9be9b7d133b36f383bee31827ef0e2b307fac725ab6ad2b1ba4c86d52edc03bdeb4bb69d50000020062a59b9800d756b52b0a5c51e529ba0d1513b0de493bacd33af401010001000100d756b52b0a5c51e529ba0d1513b0de493bacd33af80106000103ac1f279d13bf061508d6d8fa63af05615357dedd7de0d9da6aaf88b9ce5ca8af2a0e1f47559ab40dfd54ed4fb1f7b366dd2496f8fdd2e19a37fe185fca9703b57f00074248de0db2083c4436062cb39578a67c3ddbbc746fa7b2cdab2b0311740000020062a59b990052d06d40b44e0e38746f9e2188102ee48ff1c96bf40101000100010052d06d40b44e0e38746f9e2188102ee48ff1c96bf7014800010307d18b73279b14848e84d48f97576c3e6432df190b29da94df8b916570fe96f87f8f88848be1ea2365aef7af72377a0b5e68c074146fde37eaaca8f765572f2f4b8a99da495b636f2b53860ab88d2ac1fa5256bf574239d06bb2f47dfa5e38e90000020062a59b990013f84fb90413aeeda813cd5451402cc083287fd7f4010100010001006803f6f526aa2a85aa39142c14aa12ba88ba8867f801030001025dac43a5673446fb666cc75999077e634546061e86cf7395987d567a8680fb4950081aa4848584855b667a5785cd927868042fb9229665660f98ad5f1665b6be03b38270640ace7bcb744e722b33158c1db3d761314a39f0c844d17c5c63f6210000"; 

    let blockdata = hex::decode(blkdtstr).unwrap();

    let (_, block) = blocks::parse(&blockdata, 0).unwrap();

    let halfdata: Vec<u8> = blkdtstr[0..blkdtstr.len()/2].try_into().unwrap();
    println!("\n\n{}\n\n", String::from_utf8(halfdata).unwrap() );

    println!("{}\n\n", block.describe() );

    let blkdtnewstr = hex::encode( block.serialize() );

    assert_eq!( blkdtstr.to_string(), blkdtnewstr );






}